#!/bin/bash

# Updating PYTHONPATH 
base=$1
export PYTHONPATH=${PYTHONPATH:="$base/lib:$base/repo"}

node_name=$2
export COHORTE_NODE_NAME="$node_name"

http=$3
shell=$4

# Set application id
boot_forker="
/* WARNING!: do not edit, this file is generated automatically by cohorte-start-node command. */
{
	\"import-files\" : [ \"boot-forker.js\" ],
	\"composition\" : [
	{
		\"name\" : \"pelix-http-service\",
		\"properties\" : {
			\"pelix.http.port\" : $http
		}
	}, {
		\"name\" : \"pelix-remote-shell\",
		\"properties\" : {
			\"pelix.shell.port\" : $shell
		}
	}
 	]
}
"
echo "$boot_forker" > $FOLDER/$base/conf/boot-forker.js

shift 4

sh $COHORTE_HOME/run.sh $base $*

